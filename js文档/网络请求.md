# 网络请求 (JavaScript)

- ## post请求

  ```javascript
  var xhr = new XMLHttpRequest();
  xhr.open('post', 'URL_LINK');
  xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
  xhr.send('para1=hello&para2=world');
  xhr.onreadystatechange = function () {
    if (xhr.readyState == 4 && xhr.status == 200) {
        console.log(xhr.responseText);
    }
  };
  ```

- ## get请求

  ```javascript
  var ajax = new XMLHttpRequest();
  ajax.open('get', 'URL_LINK');
  ajax.send();
  ajax.onreadystatechange = function () {
      if (ajax.readyState == 4 && ajax.status == 200) {
          console.log(ajax.responseText);
      }
  }
  ```

- **<font color="#dd000">对于使用XMLHttpRequest的注意事项</font>**

  - 返回值中的`responseText`为纯字符串，如果要转换成`JSON`，见下面的`将String转换成JSON`

  - 请求完成之后的代码在`vue`语言中不能直接使用`this.xxx`的形式，需要修改`this`指针，可以这样实现：

    ```javascript
    var _this=this;
    ajax.onreadystatechange = function () {
        if (ajax.readyState == 4 && ajax.status == 200) {
            _this.getData=ajax.responseText;
        }
    }
    ```

- ## 将String转换成JSON

  可以使用方法`JSON.parse`，例如这样使用：

  ```javascript
  var name=JSON.parse(jsonData).name;
  ```


- ## 使用axios进行网络请求

  - 对于原生HTML的post请求：

    ```js
    axios.post('/api/login', {
      username: 'your_username',
      password: 'your_password'
    })
    .then(function (response) {
      console.log(response);
    })
    .catch(function (error) {
      console.log(error);
    });
    ```

  - 对于原生HTML的get请求：

    ```js
    axios.get('/api/user', {
      params: {
        id: 1
      }
    })
    .then(function (response) {
      console.log(response);
    })
    .catch(function (error) {
      console.log(error);
    });
    ```

  - 对于vue中请求

    ```js
    this.$axios({
        method:'post',	// 或者是get
        url:"/api/data",
        data:this.$qs.stringify({data1:this.data1, data2:this.data2}),	// 没有参数可以不填写
    }).then((response) => {
        // 
    }).catch((err) => {
        this.$message.error("数据库连接失败，联系管理员")
    });
    ```

    
